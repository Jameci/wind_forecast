
# 5.17

原先的模型出了一些问题，它的输入和输出没有错开——相当于用今天预测今天了

现在的mape已经到0.4了，很恐怖啊，相当于没做

尝试着增加了lstm的长度，现在是5天的480个点预测下一天的96个点，发现不太行还是0.4

放弃了那种用一天预测一天，或者用几天预测一天的方法，改成用几个点预测一个点，mape降到了0.14，但出现了明显的时滞问题

# 5.18

## 差分

昨晚试着在那个社群里提了问题，得到的答复都是做差分，或者是做差分和原数据的百分比

但没用，差分做出来的预测输出基本在0左右，实际值则一直在波动

感觉可能是lstm无法胜任这一工作

## 平稳性分析

去查找了一些关于平稳性检测的内容，发现其实平稳性不是可预测的充要条件，主要是一些统计方法如ARIMA和ARMA性能在平稳预测中效果较好，所以用统计学方法的人会在拿到时间序列之后去检验一下，如果不是平稳的就要做差分了

对于非平稳的序列来说，统计学模型不好处理(如趋势，周期)

那就先试着加一个emd分解，如果没有改善就尝试找一些辅助数据吧

## EMD

老样子，emd一点用都没有，就是在原有的误差上增加了一些新误差

## 最后的改进

预测窗口没有办法调大了，window一直保持在1是最好的，只要调大一点就会引起准确率的急剧下滑

baseline大概在0.8954左右，虽然也不多，但是足以构成难以翻越的难关了

现在的思路有：

1.换模型，这次基本上充分证明了裸的lstm是无法胜任时序预测的，可用的有tft，nbeats，加入attention和还有一些之前读过的模型等等

2.增加数据，加入温度气压等辅助数据

# 5.19

属实难受，想了一下觉得还是加点数据上去，因为之前使用tft模型也没得到很好的效果，猜测很有可能是信息量不够

去ear5

## 尝试era5的数据

### 温度和读入

#### wgrib读入

wgrib的数据属实让我大伤脑筋

直接wgrib [文件名] 会出现

1:0:d=22010100:2D:kpds5=168:kpds6=1:kpds7=0:TR=0:P1=0:P2=0:TimeU=1:sfc:anl:type=analysis:NAve=0

第一个数字代表记录索引，可以看到它是逐个递增的

第二个数字是位置

第三个数字是时间，这里的就是2022年1月1日0点

第四个是land/sea，这里的2D没看懂，后面估计也用不上，就不看了

https://ftp.cpc.ncep.noaa.gov/wd51we/wgrib/readme

还有一种比较友好的文件描述方法wgrib 文件名 -V -ncep_rean

#### anaconda

anaconda不仅仅是python发行版，最重要的它还是一个环境管理工具，可以实现环境分离，打包等等操作

conda env list可以查看当前虚拟环境，base是默认的虚拟环境

* conda list：查看环境中的所有包
* conda install XXX：安装 XXX 包
* conda remove XXX：删除 XXX 包
* conda env list：列出所有环境
* conda create -n XXX：创建名为 XXX 的环境
* conda create -n env_name jupyter notebook ：创建虚拟环境
* activate noti（或 source activate noti）：启用/激活环境
* conda env remove -n noti：删除指定环境
* deactivate（或 source deactivate）：退出环境
* jupyter notebook ：打开Jupyter Notebook
* conda config --remove-key channels ：换回默认源

先conda init cmd.exe一下，别的终端应该也一样

powershell默认不允许使用脚本，更改设置为set-ExecutionPolicy RemoteSigned

注意anaconda和原生python的区别——调用python时会使用环境变量里优先级高的(上面的)，重置环境变量后，程序要重新启动才能感觉得到(启动时会将环境变量复制到某个地方)

##### torch

又引出了新问题，torch说无法被安装，我很疑惑，跑去看官网好像有说不同的torch要用不同的命令

之后看到了有cuda，我可能明白为什么之前无法启动显卡加速了——我可能安的torch不行

然后就是找我的显卡能支持哪个版本的cuda，毕竟还是想用一下的

结果发现nivida.exe没装，或许是显卡驱动没安……

一看显卡很费，顺带搞明白了独显集显核显的区别

那就安cpu的吧

然后torch一直报错，换哪个版本都没用，后来发现之间import torch没问题，就感觉会不会是和其他的包冲突了(可能这就是直觉吧)，反正还真被我逮到了——torch和tensorflow不是一家的，他们俩有冲突

md，把torch卸载了

##### emd

emd没法用conda安装，我用的pip install EMD-signal

别忘了就行

# 5.20

彻底放弃了anaconda，装好之后频繁报错成为了压倒骆驼的最后一根稻草——我装你是为了给我解决环境问题的，而不是让你给我创造环境问题的

又花了一上午来恢复原生的python环境

但是因为改代码导致出现了严重的bug，回退了一个版本
